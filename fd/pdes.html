

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>11. Solving the Heat, Laplace and Wave Equations Using Finite Difference Methods &#8212; MATH 316</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'fd/pdes';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="12. Finite Difference Formulas" href="formulas.html" />
    <link rel="prev" title="10. Separation of Variables and Fourier Series" href="../fourier/separation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    <p class="title logo__title">MATH 316</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Ordinary Differential Equations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../odes/review.html">1. Review Of Methods To Solve Ordinary Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../odes/series.html">2. Series Solutions To ODEs With Variable Coefficients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../odes/rsps.html">3. Regular Singular Points</a></li>
<li class="toctree-l1"><a class="reference internal" href="../odes/frobenius.html">4. Frobenius Series About Regular Singular Points</a></li>
<li class="toctree-l1"><a class="reference internal" href="../odes/bessel.html">5. Besselâ€™s Equation and Bessel Functions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction to Partial Differential Equations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../intro/initial.html">6. Introduction To Partial Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/continued.html">7. Introduction To Partial Differential Equations (Continued)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/separation.html">8. Separation Of Variables And Fourier Series</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Fourier Series</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../fourier/series.html">9. Fourier Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fourier/separation.html">10. Separation of Variables and Fourier Series</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Finite Difference Method</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">11. Solving the Heat, Laplace and Wave Equations Using Finite Difference Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="formulas.html">12. Finite Difference Formulas</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Heat Equation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../heat/heat.html">13. Heat Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../heat/circular.html">14. Heat Equation On A Circular Ring - Full Fourier Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../heat/inhomogeneous.html">15. Heat Conduction Problems With Time-Independent Inhomogeneous Boundary Conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../heat/distributed.html">16. Heat Conduction With Distributed Sources/Sinks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../heat/eigenfunctions.html">17. Heat Conduction With Time Dependent Boundary Conditions Using Eigenfunction Expansions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Laplace Equation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../laplace/laplace.html">18. Laplace Equation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Wave Equation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../wave/wave.html">19. Wave Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wave/1d.html">20. The 1D Wave Equation and Dâ€™Alembertâ€™s Solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wave/dalembert.html">21. Interpretating Dâ€™Alembertâ€™s Solution in Space-Time</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wave/finite.html">22. The Wave Equation On Finite Domains - Solution By Separation Of Variables</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/UBCMath/math316" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/fd/pdes.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Solving the Heat, Laplace and Wave Equations Using Finite Difference Methods</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#finite-difference-methods">11.1. Finite Difference Methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#approximating-the-derivatives-of-a-function-by-finite-differences">11.1.1. Approximating the Derivatives of a Function by Finite Differences</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-the-heat-equations-using-the-method-of-finite-differences">11.1.2. Solving The Heat Equations Using The Method Of Finite Differences</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stability-of-the-finite-difference-scheme-for-the-heat-equation">11.1.2.1. Stability of the Finite Difference Scheme for the Heat Equation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises-on-finite-differences-applied-to-the-heat-equation">11.1.2.2. Exercises on Finite Differences Applied to the Heat Equation</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finite-difference-scheme-for-the-1d-wave-equation">11.1.3. Finite Difference Scheme For The 1D Wave Equation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stability-of-the-finite-difference-scheme-for-the-wave-equation">11.1.3.1. Stability of the Finite Difference Scheme for the Wave Equation</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-laplace-s-equation-using-finite-differences">11.1.4. Solving Laplaceâ€™s Equation Using Finite Differences</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-the-system-of-equations-by-jacobi-iteration">11.1.4.1. Solving the System of Equations by Jacobi Iteration</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises-for-laplace-s-equation">11.1.4.2. Exercises for Laplaceâ€™s Equation</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="math notranslate nohighlight">
\[
\newenvironment{remark}{\begin{Remark}\rm}{\end{Remark}}
\newenvironment{exercise}{\begin{Exercise}\rm}{\end{Exercise}}
\newcommand{\N}[1]{\left\|#1\right\|}
\newcommand{\abs}[1]{|#1|}
\newcommand{\mat}[1]{{\mathbf #1}}
\newcommand{\vect}[1]{\underline{#1}}
\newcommand{\njump}[1]{[|#1|]}
\newcommand{\bke}[1]{\left ( #1 \right )}
\newcommand{\bkt}[1]{\left [ #1 \right ]}
\newcommand{\bket}[1]{\left \{ #1 \right \}}
\newcommand{\norm}[1]{\left \| #1 \right \|}
\newcommand{\bka}[1]{\left \langle #1 \right \rangle}
\newcommand{\ve}[1]{\mathbf{#1}}
\newcommand{\what}[1]{\widehat{#1}}
\]</div>
<section class="tex2jax_ignore mathjax_ignore" id="solving-the-heat-laplace-and-wave-equations-using-finite-difference-methods">
<h1><span class="section-number">11. </span>Solving the Heat, Laplace and Wave Equations Using Finite Difference Methods<a class="headerlink" href="#solving-the-heat-laplace-and-wave-equations-using-finite-difference-methods" title="Permalink to this headline">#</a></h1>
<p>In this lecture we introduce the finite difference method that is
widely used for approximating PDEs using the computer. We use the
definition of the derivative and Taylor series to derive finite
difference approximations to the first and second derivatives of a
function. We then use these finite difference quotients to
approximate the derivatives in the heat equation and to derive a
finite difference approximation to the heat equation. Similarly, the
technique is applied to the wave equation and Laplaceâ€™s Equation.
The technique is illustrated using EXCEL spreadsheets.</p>
<div class="admonition-key-concepts admonition">
<p class="admonition-title">Key Concepts</p>
<p>Finite Difference Approximations to
derivatives, The Finite Difference Method, The Heat Equation, The
Wave Equation, Laplaceâ€™s Equation.</p>
</div>
<section id="finite-difference-methods">
<h2><span class="section-number">11.1. </span>Finite Difference Methods<a class="headerlink" href="#finite-difference-methods" title="Permalink to this headline">#</a></h2>
<section id="approximating-the-derivatives-of-a-function-by-finite-differences">
<span id="fd-intro"></span><h3><span class="section-number">11.1.1. </span>Approximating the Derivatives of a Function by Finite Differences<a class="headerlink" href="#approximating-the-derivatives-of-a-function-by-finite-differences" title="Permalink to this headline">#</a></h3>
<p>Recall that the derivative of a function was defined by taking the
limit of a difference quotient:</p>
<div class="math notranslate nohighlight" id="equation-derivative">
<span class="eqno">(11.1)<a class="headerlink" href="#equation-derivative" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray}
f'(x)=\lim\limits_{\Delta x\rightarrow 0}\frac{f(x+\Delta x)-f(x)}{\Delta x}
\label{Derivative}
\end{eqnarray}
\]</div>
<p>Now to use the computer to solve differential equations we go in the
opposite direction - we replace derivatives by appropriate
difference quotients. If we assume that the function can be
differentiated many times then Taylorâ€™s Theorem is a very useful
device to determine the appropriate difference quotient to use. For
example, consider</p>
<div class="math notranslate nohighlight" id="equation-taylor">
<span class="eqno">(11.2)<a class="headerlink" href="#equation-taylor" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray}
f(x+\Delta x)=f(x)+\Delta xf'(x)+\frac{\Delta x^2}{2!}f''(x)+\frac{\Delta
x^3}{3!}f^{(3)}(x)+\frac{\Delta x^4}{4!}f^{(4)}(x)+\ldots
\label{Taylor}
\end{eqnarray}
\]</div>
<p>Re-arranging terms in <a class="reference internal" href="#equation-taylor">(11.2)</a> and dividing by <span class="math notranslate nohighlight">\(\Delta x\)</span> we
obtain</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-2">
<span class="eqno">(11.3)<a class="headerlink" href="#equation-ref-fd-pdes-2" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray*}
\frac{f(x+\Delta x)-f(x)}{\Delta x}=f'(x)+\frac{\Delta x}{2}f''(x)+\frac{\Delta
x^2}{3!}f^{(3)}(x)+\ldots .
\end{eqnarray*}
\]</div>
<p>If we take the limit <span class="math notranslate nohighlight">\(\Delta x\rightarrow 0\)</span> then we recover
<a class="reference internal" href="#equation-derivative">(11.1)</a>. But for our purposes it is more useful to retain
the approximation</p>
<div class="math notranslate nohighlight" id="equation-forwarddiff">
<span class="eqno">(11.4)<a class="headerlink" href="#equation-forwarddiff" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{eqnarray}
\frac{f(x+\Delta x)-f(x)}{\Delta x} &amp; = &amp; f'(x)+\frac{\Delta x}{2}f''(\xi )\\
&amp; = &amp; f'(x)+O(\Delta x)\label{ForwardDiff} .
\end{eqnarray}
\end{split}\]</div>
<p>We retain the term <span class="math notranslate nohighlight">\(\displaystyle\frac{\Delta x}{2}f''(\xi )\)</span> in
<a class="reference internal" href="#equation-forwarddiff">(11.4)</a> as a measure of the error involved when we
approximate <span class="math notranslate nohighlight">\(f'(x)\)</span> by the difference quotient <span class="math notranslate nohighlight">\(\big( f(x+\Delta
x)-f(x)\big) /\Delta x\)</span>. Notice that this error depends on how large
<span class="math notranslate nohighlight">\(f''\)</span> is in the interval <span class="math notranslate nohighlight">\([x,x+\Delta x]\)</span> (i.e. on the smoothness of
<span class="math notranslate nohighlight">\(f\)</span>) and on the size of <span class="math notranslate nohighlight">\(\Delta x\)</span>. Since we like to focus on that part
of the error we can control we say that the error term is of the
order <span class="math notranslate nohighlight">\(\Delta x\)</span> â€“ denoted by <span class="math notranslate nohighlight">\(O(\Delta x)\)</span>. Technically a term or
function <span class="math notranslate nohighlight">\(E(\Delta x)\)</span> is <span class="math notranslate nohighlight">\(O(\Delta x)\)</span> if</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-4">
<span class="eqno">(11.5)<a class="headerlink" href="#equation-ref-fd-pdes-4" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray*}
\frac{E(\Delta x)}{\Delta x} \stackrel{\Delta x\rightarrow 0}{\rightarrow}\quad\mbox{const}.
\end{eqnarray*}
\]</div>
<p>Now the difference quotient <a class="reference internal" href="#equation-forwarddiff">(11.4)</a> is not the only
one that can be used to approximate <span class="math notranslate nohighlight">\(f'(x)\)</span>. Indeed, if we consider
the expansion of <span class="math notranslate nohighlight">\(f(x-\Delta x)\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-taylorminus">
<span class="eqno">(11.6)<a class="headerlink" href="#equation-taylorminus" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray}
f(x-\Delta x)=f(x)-\Delta xf'(x)+\frac{\Delta x^2}{2!}f''(x)-\frac{\Delta
x^3}{3!}f^{(3)}( x)+\frac{\Delta x^4}{4!}f^{(4)}(x)+\ldots
\label{Taylorminus}
\end{eqnarray}
\]</div>
<p>and we subtract <a class="reference internal" href="#equation-taylorminus">(11.6)</a> from <a class="reference internal" href="#equation-taylor">(11.2)</a>, and divide
by <span class="math notranslate nohighlight">\((2\Delta x)\)</span> we obtain:</p>
<div class="math notranslate nohighlight" id="equation-centraldiff1">
<span class="eqno">(11.7)<a class="headerlink" href="#equation-centraldiff1" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray}
\frac{f(x+\Delta x)-f(x-\Delta x)}{2\Delta x}=f'(x)+\frac{\Delta
x^2}{3!}f^{(3)}(\xi ) \label{CentralDiff1}
\end{eqnarray}
\]</div>
<p>We notice that the error term associated with this form of
difference approximation is <span class="math notranslate nohighlight">\(O(\Delta x^2)\)</span>, which converges more
rapidly to zero as <span class="math notranslate nohighlight">\(\Delta x\rightarrow 0\)</span>.</p>
<p>In order to obtain an approximation to <span class="math notranslate nohighlight">\(f''(x)\)</span> we add
<a class="reference internal" href="#equation-taylorminus">(11.6)</a> to <a class="reference internal" href="#equation-taylor">(11.2)</a>, which upon re-arrangement and
dividing by <span class="math notranslate nohighlight">\(\Delta x^2\)</span> leads to:</p>
<div class="math notranslate nohighlight" id="equation-centraldiff2">
<span class="eqno">(11.8)<a class="headerlink" href="#equation-centraldiff2" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray}
\frac{f(x+\Delta x)-2f(x)+f(x-\Delta x)}{\Delta x^2}=f''(x)+\frac{1}{12}\Delta
x^2f^{(4)}(\xi ) \label{CentralDiff2}
\end{eqnarray}
\]</div>
<p>Due to the symmetry of the difference approximations
<a class="reference internal" href="#equation-centraldiff1">(11.7)</a> and <a class="reference internal" href="#equation-centraldiff2">(11.8)</a> about the expansion
point <span class="math notranslate nohighlight">\(x\)</span> these are called central difference approximations. The
difference approximation <a class="reference internal" href="#equation-forwarddiff">(11.4)</a> is known as a forward
difference approximation. We note that the central difference
schemes <a class="reference internal" href="#equation-centraldiff1">(11.7)</a> and <a class="reference internal" href="#equation-centraldiff2">(11.8)</a> are second
order accurate while the forward difference scheme
<a class="reference internal" href="#equation-forwarddiff">(11.4)</a> is only accurate to <span class="math notranslate nohighlight">\(O(\Delta x)\)</span>.</p>
</section>
<section id="solving-the-heat-equations-using-the-method-of-finite-differences">
<h3><span class="section-number">11.1.2. </span>Solving The Heat Equations Using The Method Of Finite Differences<a class="headerlink" href="#solving-the-heat-equations-using-the-method-of-finite-differences" title="Permalink to this headline">#</a></h3>
<p>Consider the following initial-boundary value problem for the heat
equation</p>
<div class="math notranslate nohighlight" id="equation-heateq">
<span class="eqno">(11.9)<a class="headerlink" href="#equation-heateq" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{eqnarray}
\frac{\partial u}{\partial t} &amp;=&amp; \alpha^2\frac{\partial ^2u}{\partial x^2}\quad 0&lt;x&lt;1, t&gt;0 \label{HeatEq}\\
\mbox{BC:}\quad u(0,t)&amp;=&amp; 0\quad u(1,t)=0 \label{DirichletBC}\\
\mbox{IC:}\quad u(x,0) &amp;=&amp; f(x).
\end{eqnarray}
\end{split}\]</div>
<p>The basic idea is to replace the derivatives in the heat equation by
difference quotients. We consider the relationships between <span class="math notranslate nohighlight">\(u\)</span> at
<span class="math notranslate nohighlight">\((x,t)\)</span> and its neighbours a distance <span class="math notranslate nohighlight">\(\Delta x\)</span> apart and at a time
<span class="math notranslate nohighlight">\(\Delta t\)</span> later.</p>
<p>Corresponding to the difference quotient approximations introduced
in <a class="reference internal" href="#fd-intro"><span class="std std-ref">Approximating the Derivatives of a Function by Finite Differences</span></a>, we consider the following partial difference
approximations.</p>
<p><em><strong>Forward Difference in Time:</strong></em></p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-9">
<span class="eqno">(11.10)<a class="headerlink" href="#equation-ref-fd-pdes-9" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray*}
u(x,t+\Delta t)=u(x,t)+\Delta t\frac{\partial u}{\partial t} (x,t)+\frac{\Delta
t^2}{2!}\frac{\partial ^2u}{\partial t^2} (x,t)+\cdots .
\end{eqnarray*}
\]</div>
<p>After re-arrangement and division by <span class="math notranslate nohighlight">\(\Delta t\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-timedifference">
<span class="eqno">(11.11)<a class="headerlink" href="#equation-timedifference" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray}
\frac{u(x,t+\Delta t)-u(x,t)}{\Delta t} =\frac{\partial u}{\partial t}(u,t)+O(\Delta t)
\label{TimeDifference}
\end{eqnarray}
\]</div>
<p><em><strong>Central Differences in Space:</strong></em></p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-11">
<span class="eqno">(11.12)<a class="headerlink" href="#equation-ref-fd-pdes-11" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{eqnarray*}
u(x+\Delta x,t) &amp;=&amp; u(x,t)+\Delta x\frac{\partial u}{\partial x}(x,t) +\frac{\Delta
x^2}{2!}\frac{\partial^2u}{\partial x^2}(u,t) +\frac{\Delta x^3}{3!}\frac{\partial
^3u}{\partial x^3}(x,t)
+\frac{\Delta x^4}{4!}\frac{\partial ^4u}{\partial x^2}(x,t)+\cdots \\
u(x-\Delta x,t) &amp;=&amp; u(x,t)-\Delta x\frac{\partial u}{\partial x}(x,t) +\frac{\Delta
x^2}{2!}\frac{\partial ^2u}{\partial x^2}(x,t) -\frac{\Delta x^3}{3!}\frac{\partial
^3u}{\partial x^3}(x,t) +\frac{\Delta x^4}{4!}\frac{\partial ^4u}{\partial
x^4}(x,t)+\cdots .
\end{eqnarray*}
\end{split}\]</div>
<p>Adding and re-arranging:</p>
<div class="math notranslate nohighlight" id="equation-centraldiffspace">
<span class="eqno">(11.13)<a class="headerlink" href="#equation-centraldiffspace" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray}
\frac{u(x+\Delta x,t)-2u(x,t)+u(x-\Delta x,t)}{\Delta x^2}=\frac{\partial ^2u}{\partial
x^2}(x,t) +O(\Delta x^2) \label{CentralDiffSpace}
\end{eqnarray}
\]</div>
<p>Substituting <a class="reference internal" href="#equation-timedifference">(11.11)</a> and <a class="reference internal" href="#equation-centraldiffspace">(11.13)</a>
into <a class="reference internal" href="#equation-heateq">(11.9)</a> we obtain</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-13">
<span class="eqno">(11.14)<a class="headerlink" href="#equation-ref-fd-pdes-13" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray*}
\frac{u(x,t+\Delta t)-u(x,t)}{\Delta t}=\alpha ^2\left( \frac{u(x+\Delta
x,t)-2u(x,t)+u(x-\Delta x,t)}{\Delta x^2}\right) +O(\Delta t,\Delta x^2) .
\end{eqnarray*}
\]</div>
<p>Re-arranging:</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-14">
<span class="eqno">(11.15)<a class="headerlink" href="#equation-ref-fd-pdes-14" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray}
u(x,t+\Delta t)=u(x,t)+\alpha ^2\left(\frac{\Delta t}{\Delta x^2}\right) \left\{
u(x+\Delta x,t)-2u(x,t)+u(x-\Delta x,t)\right\} .
\end{eqnarray}
\]</div>
<p>We subdivide the spatial interval <span class="math notranslate nohighlight">\([0,1]\)</span> into <span class="math notranslate nohighlight">\(N+1\)</span> equally spaced
sample points <span class="math notranslate nohighlight">\(x_n=n\Delta x\)</span>. The time interval <span class="math notranslate nohighlight">\([0,T]\)</span> is subdivided
into <span class="math notranslate nohighlight">\(M+1\)</span> equal time levels <span class="math notranslate nohighlight">\(t_k=k\Delta t\)</span>. At each of these
space-time sample points we introduce approximations:</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-15">
<span class="eqno">(11.16)<a class="headerlink" href="#equation-ref-fd-pdes-15" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray*}
u(x_n,t_k)\simeq u_n^k.
\end{eqnarray*}
\]</div>
<figure class="align-center" id="fd-scheme">
<img alt="fd_schem" src="../_images/heat_eq_scheme.png" />
</figure>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-16">
<span class="eqno">(11.17)<a class="headerlink" href="#equation-ref-fd-pdes-16" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray*}
u_n^{k+1}=u_n^k+\alpha ^2\left(\frac{\Delta t}{\Delta x^2}\right) \left(
u_{n+1}^k-2u_n^k+u_{n-1}^k\right)
\end{eqnarray*}
\]</div>
<p><em><strong>Implementing Derivative Boundary Conditions:</strong></em></p>
<p>Assume that the boundary conditions for <a class="reference internal" href="#equation-heateq">(11.9)</a> are changed
to</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-17">
<span class="eqno">(11.18)<a class="headerlink" href="#equation-ref-fd-pdes-17" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray*}
\mbox{BC:}\quad u(0,t)=0,\quad\frac{\partial u}{\partial x}(1,t)=0.
\end{eqnarray*}
\]</div>
<p>Consider a central difference approximation to <span class="math notranslate nohighlight">\(\displaystyle\frac{\partial u}{\partial
x}(1,t)\)</span>, where <span class="math notranslate nohighlight">\(x_N=N \Delta x = 1\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-18">
<span class="eqno">(11.19)<a class="headerlink" href="#equation-ref-fd-pdes-18" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray*}
\frac{u(x_N+\Delta x,t)-u(x_N-\Delta x,t)}{\Delta x}=0.
\end{eqnarray*}
\]</div>
<p>Re-arranging we obtain:</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-19">
<span class="eqno">(11.20)<a class="headerlink" href="#equation-ref-fd-pdes-19" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray*}
u(x_N+\Delta x,t)=u(x_N-\Delta x,t)\quad (*)
\end{eqnarray*}
\]</div>
<p>Since <span class="math notranslate nohighlight">\(x_N=1\)</span> we observe that <span class="math notranslate nohighlight">\(x_N+\Delta x\)</span> is outside the domain. To
accomodate this we introduce an extra column <span class="math notranslate nohighlight">\(u_{N+1}\)</span> into which we
copy the values <span class="math notranslate nohighlight">\(u_{N-1}\)</span>. In the column <span class="math notranslate nohighlight">\(x_N\)</span> we implement the same
difference approximation for the Heat Equation, namely:</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-20">
<span class="eqno">(11.21)<a class="headerlink" href="#equation-ref-fd-pdes-20" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray*}
u_N^{k+1}=u_N^k+\alpha ^2( \frac{\Delta t}{\Delta x^2} )
(u_{N+1}^k-2u_N^k+u_{N-1}^k) \quad (**)
\end{eqnarray*}
\]</div>
<p>While <span class="math notranslate nohighlight">\(u_{N+1}^k=u_{N-1}^k \)</span> (see (*) ) since column
<span class="math notranslate nohighlight">\(u_{N-1}^k\)</span> is copied to column <span class="math notranslate nohighlight">\(u_{N+1}^k\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This BC could be implemented another way without introducing the additional
column, by eliminating <span class="math notranslate nohighlight">\(u_{N+1}\)</span> from <span class="math notranslate nohighlight">\((*)\)</span> and <span class="math notranslate nohighlight">\((**)\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-21">
<span class="eqno">(11.22)<a class="headerlink" href="#equation-ref-fd-pdes-21" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray*}
u_{N}^{k+1}=u_N^k+2\alpha ^2\left(\frac{\Delta t}{\Delta x^2}\right)\left(
u_{N-1}^k-u_N^k\right) .
\end{eqnarray*}
\]</div>
<p>If this latter equation is implemented at <span class="math notranslate nohighlight">\(x_N\)</span> there is no need to
introduce an extra column <span class="math notranslate nohighlight">\(u_{N+1}\)</span> or to implement the difference
equation given in (**) as the the derivative boundary condition is
taken care of automatically.</p>
</div>
<section id="stability-of-the-finite-difference-scheme-for-the-heat-equation">
<h4><span class="section-number">11.1.2.1. </span>Stability of the Finite Difference Scheme for the Heat Equation<a class="headerlink" href="#stability-of-the-finite-difference-scheme-for-the-heat-equation" title="Permalink to this headline">#</a></h4>
<p>Consider the following finite difference approximation to the 1D heat equation:</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-22">
<span class="eqno">(11.23)<a class="headerlink" href="#equation-ref-fd-pdes-22" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray*}
u_n^{k+1}-u_n^k=\frac{\Delta t}{\Delta x^2} \left(
u_{n+1}^k-2u_n^k+u_{n-1}^k\right)\quad \mbox{where} \quad u_n^k\simeq
u(x_n,t_k)
\end{eqnarray*}
\]</div>
<p>Let <span class="math notranslate nohighlight">\(\displaystyle u_n^k=\phi_ke^{in\Delta x\theta}\)</span> then</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-23">
<span class="eqno">(11.24)<a class="headerlink" href="#equation-ref-fd-pdes-23" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{eqnarray*}
(\phi_{k+1}-\phi_k) e^{in\Delta x\theta} &amp;=&amp; \frac{\Delta t}{\Delta x^2} \left( e^{i\Delta x\theta}-2+e^{-i\Delta x\theta}\right) \phi_k e^{in\Delta x\theta}\\
&amp;=&amp; \frac{\Delta t}{\Delta x^2}\left[ 2\cos (\theta\Delta x)-2\right]\phi_k e^{in\Delta x\theta}
\end{eqnarray*}
\end{split}\]</div>
<p>Therefore</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-24">
<span class="eqno">(11.25)<a class="headerlink" href="#equation-ref-fd-pdes-24" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{eqnarray*}
\phi_{k+1}&amp;=&amp;\phi_k-\frac{\Delta t}{\Delta x^2}4\sin^2\left(\frac{\theta\Delta x}{2}\right)\phi_k \quad \mbox{since} \quad\cos (\theta\Delta x)-1=-2\sin^2 \left(\frac{\theta\Delta x}{2}\right)\\
&amp;=&amp;\left[1-\frac{4\Delta t}{\Delta x^2}\sin^2\left(\frac{\theta\Delta
x}{2}\right)\right]\phi_k
\end{eqnarray*}
\end{split}\]</div>
<p>Now for stability we require that <span class="math notranslate nohighlight">\(|\phi_{k+1}|\leq |\phi_k|\)</span> so that</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-25">
<span class="eqno">(11.26)<a class="headerlink" href="#equation-ref-fd-pdes-25" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{eqnarray*}
&amp;&amp;\left| 1-\frac{4\Delta t}{\Delta x^2}\sin^2\left(\frac{\theta\Delta x}{2}\right)\right|\leq 1\\
\rightarrow &amp;&amp;-2\leq -\frac{4\Delta t}{\Delta
x^2}\sin^2\left(\frac{\theta\Delta x}{2}\right)\leq 0
\end{eqnarray*}
\end{split}\]</div>
<p>The right inequality is satisfied automatically, while the left inequality can be re-written
in the form:</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-26">
<span class="eqno">(11.27)<a class="headerlink" href="#equation-ref-fd-pdes-26" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray*}
&amp;\frac{4\Delta t}{\Delta x^2}\sin^2\left(\frac{\theta\Delta x}{2}\right)\leq 2
\end{eqnarray*}
\]</div>
<p>Since <span class="math notranslate nohighlight">\(\sin^2(\ \ )\leq 1\)</span> this condition is satisfied for all
<span class="math notranslate nohighlight">\(\theta\)</span> provided</p>
<div class="math notranslate nohighlight" id="equation-eqstabilitycondheat">
<span class="eqno">(11.28)<a class="headerlink" href="#equation-eqstabilitycondheat" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray}
\Delta t\le\frac{\Delta x^2}{2} \label{eqStabilityCondHeat}
\end{eqnarray}
\]</div>
</section>
<section id="exercises-on-finite-differences-applied-to-the-heat-equation">
<h4><span class="section-number">11.1.2.2. </span>Exercises on Finite Differences Applied to the Heat Equation<a class="headerlink" href="#exercises-on-finite-differences-applied-to-the-heat-equation" title="Permalink to this headline">#</a></h4>
<p><em><strong>Numerical Instability:</strong></em></p>
<p>(a) Change the <span class="math notranslate nohighlight">\(\Delta t\)</span> in cell D1 from <span class="math notranslate nohighlight">\(0{.}001\)</span> to <span class="math notranslate nohighlight">\(0{.}05\)</span> and
you will observe what is known as a numerical instability. Now
change <span class="math notranslate nohighlight">\(\Delta t\)</span> to <span class="math notranslate nohighlight">\(0{.}00625\)</span>, which is known as the stability
boundary predicted by <a class="reference internal" href="#equation-eqstabilitycondheat">(11.28)</a> and observe what
happens. Now let <span class="math notranslate nohighlight">\(\Delta t=0{.}006\)</span> and observe the abrupt change in
the solution - it is much closer to what we would expect.</p>
<p>(b) Derive the stability condition for
the finite difference approximation of the 1D heat equation when
<span class="math notranslate nohighlight">\(\alpha^2\ne 1\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-28">
<span class="eqno">(11.29)<a class="headerlink" href="#equation-ref-fd-pdes-28" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray*}
\mbox{i.e.}\quad u_n^{k+1}-u_n^k=\frac{\alpha^2\Delta t}{\Delta x^2}\left(
u_{n+1}^k-2u_n^k+u_{n-1}^k\right)
\end{eqnarray*}
\]</div>
<p><em><strong>Truncation Error:</strong></em></p>
<p>The instability noted in 1 above is not the only source of error in the numerical approximation.
Although numerical instability is evident for a parameter choice
that is unstable, the other type of error is present in almost every
type of numerical approximation scheme.  This class of error results
from discarding the <span class="math notranslate nohighlight">\(O(\Delta x^2)\)</span> and <span class="math notranslate nohighlight">\(O(\Delta t)\)</span> terms in <a class="reference internal" href="#equation-centraldiff1">(11.7)</a> and <a class="reference internal" href="#equation-forwarddiff">(11.4)</a>
when we replace derivatives in <a class="reference internal" href="#equation-heateq">(11.9)</a> by difference quotients. This error is known as the truncation error. To estimate the magnitude of the truncation
error, change the spread sheet to implement the initial condition</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-29">
<span class="eqno">(11.30)<a class="headerlink" href="#equation-ref-fd-pdes-29" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{eqnarray*}
f(x)=\left\{\begin{array}{ll}2x &amp;0&lt;x&lt;1/2\\ 2(1-x)&amp;1/2\leq
x&lt;1\end{array}\right. .
\end{eqnarray*}
\end{split}\]</div>
<p>Now code up the Fourier Series (in another spread sheet) that is
derived in Lecture 10, Exercise 10.1 and compare the numerical
solution to the `exactâ€™ Fourier Series solution with 50 terms. The
difference between the two is mainly due to the truncation error
since the round-off error is about <span class="math notranslate nohighlight">\(10^{-12}\)</span> and does not grow if
stable parameters are used.</p>
<p><em><strong>Derivative Boundary Conditions:</strong></em></p>
<p>Implement a derivative boundary condition the left endpoint <span class="math notranslate nohighlight">\(x=0\)</span>.
Check the numerical solution against the problem solved in Lecture
11.</p>
</section>
</section>
<section id="finite-difference-scheme-for-the-1d-wave-equation">
<h3><span class="section-number">11.1.3. </span>Finite Difference Scheme For The 1D Wave Equation<a class="headerlink" href="#finite-difference-scheme-for-the-1d-wave-equation" title="Permalink to this headline">#</a></h3>
<p>Consider the following initial boundary value problem for the Wave
Equation:</p>
<div class="math notranslate nohighlight" id="equation-eqwavevelic">
<span class="eqno">(11.31)<a class="headerlink" href="#equation-eqwavevelic" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{eqnarray}
u_{tt}&amp;=&amp;c^2u_{xx}\quad 0&lt;x&lt;L\\
\mbox{BC:}\quad u(0,t) &amp;=&amp; 0\quad u(L,t)=0\\
\mbox{IC:}\quad u(x,0)&amp;=&amp;f(x)\\
\frac{\partial u}{\partial t}(x,0)&amp;=&amp;g(x) \label{eqwaveVelIC}
\end{eqnarray}
\end{split}\]</div>
<p>We introduce a finite difference mesh <span class="math notranslate nohighlight">\(x_n=n\Delta t\)</span>, <span class="math notranslate nohighlight">\(t_k=k\Delta t\)</span> and
let the corresponding nodal values be denoted by</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-31">
<span class="eqno">(11.32)<a class="headerlink" href="#equation-ref-fd-pdes-31" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray*}
u_n^k\simeq u(x_n,t_k).
\end{eqnarray*}
\]</div>
<figure class="align-center" id="fd-scheme-wave">
<img alt="fd_scheme_wave" src="../_images/wave_eq_scheme.png" />
</figure>
<p>Now approximating derivatives by central differences both in space
and time we obtain</p>
<div class="math notranslate nohighlight" id="equation-eq-fd-wavekgen">
<span class="eqno">(11.33)<a class="headerlink" href="#equation-eq-fd-wavekgen" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{eqnarray}
\frac{u_n^{k+1}-2u_n^k+u_n^{k-1}}{\Delta t^2}&amp;=&amp;c^2\left(\frac{u_{n+1}^k-2u_n^k+u_{n-1}^k}{\Delta x^2}\right) +O(\Delta x^2,\Delta t^2).\\
\mbox{Therefore}\quad u_n^{k+1}&amp;=&amp;2u_n^k-u_n^{k-1}+{\left(\frac{c\Delta t}{\Delta x}\right)}^2\big( u_{n+1}^k-2u_n^k+u_{n-1}^k\big)\nonumber\\
\underbrace{u_n^{k+1}}_{\mbox{time level $k+1$}}&amp;=&amp;
\underbrace{r^2u_{n+1}^k+2(1-r^2)u_n^k+r^2u_{n-1}^k}_{\mbox{time
level $k$}}-\underbrace{u_n^{k-1}}_{\mbox{time level $k-1$}}
\label{eq_FD_Wavekgen}
\end{eqnarray}
\end{split}\]</div>
<p>Here <span class="math notranslate nohighlight">\(r=(c\Delta t/\Delta x)\)</span> is known as the Courant Number. We observe
that the Discrete Equation <a class="reference internal" href="#equation-eq-fd-wavekgen">(11.33)</a> involves three
distinct levels in which known data is transferred from steps <span class="math notranslate nohighlight">\(k-1\)</span>
and <span class="math notranslate nohighlight">\(k\)</span> to step <span class="math notranslate nohighlight">\(k+1\)</span>.</p>
<p><em><strong>Initial Conditions - Starting the Solution</strong></em></p>
<p>The 3-level scheme poses some challenges when imposing the initial
conditions. If we imagine a row of false mesh points at time <span class="math notranslate nohighlight">\(t=-\Delta
t=t_{-1}\)</span>, then the initial velocity condition <a class="reference internal" href="#equation-eqwavevelic">(11.31)</a>
can be approximated using central differences as:</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-33">
<span class="eqno">(11.34)<a class="headerlink" href="#equation-ref-fd-pdes-33" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray}
\frac{u_n^1-u_n^{-1}}{2\Delta t}&amp; = &amp; g(x_n)\label{FalseICWaveEq}
\end{eqnarray}
\]</div>
<p>therefore</p>
<div class="math notranslate nohighlight" id="equation-eqwaveic">
<span class="eqno">(11.35)<a class="headerlink" href="#equation-eqwaveic" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray}
u_n^{-1}&amp;=&amp;u_n^1-2 \Delta t g(x_n) \label{eqWaveIC}
\end{eqnarray}
\]</div>
<p>Now we assume that the Discrete Wave Equation <a class="reference internal" href="#equation-eq-fd-wavekgen">(11.33)</a>
also holds at <span class="math notranslate nohighlight">\(t=0\)</span> so that</p>
<div class="math notranslate nohighlight" id="equation-eq-fd-wavekeq1">
<span class="eqno">(11.36)<a class="headerlink" href="#equation-eq-fd-wavekeq1" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray}
u_n^1=r^2u_{n+1}^0+2(1-r^2)u_n^0+r^2u_{n-1}^0-u_n^{-1}
\label{eq_FD_Wavekeq1}
\end{eqnarray}
\]</div>
<p>Substituting <a class="reference internal" href="#equation-eqwaveic">(11.35)</a> into <a class="reference internal" href="#equation-eq-fd-wavekeq1">(11.36)</a> and
re-arranging we obtain:</p>
<div class="math notranslate nohighlight" id="equation-eq-fd-wavekeq1c">
<span class="eqno">(11.37)<a class="headerlink" href="#equation-eq-fd-wavekeq1c" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray}
u_n^1=\frac{1}{2}(r^2u_{n+1}^0+2(1-r^2)u_n^0+r^2u_{n-1}^0)+\Delta t
g(x_n) \label{eq_FD_Wavekeq1c}
\end{eqnarray}
\]</div>
<p>Since <span class="math notranslate nohighlight">\(u_n^0=f(x_n)\)</span> and <span class="math notranslate nohighlight">\(g(x_n)\)</span> are known, we are now in a
position to specify the first two rows of nodes. This is sufficient
to start the recursion <a class="reference internal" href="#equation-eq-fd-wavekgen">(11.33)</a> for all subsequent
steps.</p>
<figure class="align-center" id="false-mesh">
<img alt="wave_scheme_false_mesh" src="../_images/wave_scheme_false_mesh.png" />
<figcaption>
<p><span class="caption-number">Fig. 11.1 </span><span class="caption-text">8.20 refers to <a class="reference internal" href="#equation-eq-fd-wavekgen">(11.33)</a> and 8.24 refers to <a class="reference internal" href="#equation-eq-fd-wavekeq1c">(11.37)</a>.
<span class="math notranslate nohighlight">\(\bullet=\)</span> nodes and <span class="math notranslate nohighlight">\(\circ=\)</span> false mesh points used to derive <a class="reference internal" href="#equation-eq-fd-wavekeq1c">(11.37)</a>
but not actually used in the computation.</span><a class="headerlink" href="#false-mesh" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<section id="stability-of-the-finite-difference-scheme-for-the-wave-equation">
<h4><span class="section-number">11.1.3.1. </span>Stability of the Finite Difference Scheme for the Wave Equation<a class="headerlink" href="#stability-of-the-finite-difference-scheme-for-the-wave-equation" title="Permalink to this headline">#</a></h4>
<p>Consider the following finite difference approximation to the 1D
wave equation:</p>
<div class="math notranslate nohighlight" id="equation-fdwaveeqgen">
<span class="eqno">(11.38)<a class="headerlink" href="#equation-fdwaveeqgen" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray}
u_n^{k+1}=r^2u_{n+1}^k+2(1-r^2)u_n^k+r^2u_{n-1}^k-u_n^{k-1}
\label{FDWaveEqGen}
\end{eqnarray}
\]</div>
<p>and, as in the case of the heat equation, substitute <span class="math notranslate nohighlight">\(\displaystyle
u_n^k=\phi_ke^{in\Delta x\theta}\)</span> into <a class="reference internal" href="#equation-fdwaveeqgen">(11.38)</a></p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-38">
<span class="eqno">(11.39)<a class="headerlink" href="#equation-ref-fd-pdes-38" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray*}
e^{in\Delta x\theta }\phi _{k+1}=\left( r^{2}e^{i\Delta x\theta
}+2\left( 1-r^{2}\right) +r^{2}e^{-i\Delta x\theta }\right)
e^{in\Delta x\theta }\phi _{k}-e^{in\Delta x\theta }\phi _{k-1}
\end{eqnarray*}
\]</div>
<p>Canceling terms and using the double angle formulae</p>
<div class="math notranslate nohighlight" id="equation-wavestabeq">
<span class="eqno">(11.40)<a class="headerlink" href="#equation-wavestabeq" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{eqnarray}
\phi _{k+1} &amp;=&amp;2\left( 1+r^{2}\left( \cos \Delta x\theta -1\right)
\right)
\phi _{k}-\phi _{k-1} \\
&amp;=&amp;2\left( 1-2r^{2}\sin ^{2}\frac{\Delta x\theta }{2}\right) \phi
_{k}-\phi _{k-1} \label{waveStabEq}
\end{eqnarray}
\end{split}\]</div>
<p>If we now assume that <span class="math notranslate nohighlight">\(\phi _{k}\)</span> has the following exponential
form <span class="math notranslate nohighlight">\(\phi _{k}=G^{k}\)</span> then <a class="reference internal" href="#equation-wavestabeq">(11.40)</a> reduces to the
following quadratic equation:</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-40">
<span class="eqno">(11.41)<a class="headerlink" href="#equation-ref-fd-pdes-40" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray}
G^{2}-2\gamma G+1=0 \label{StabQuadratic}
\end{eqnarray}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\gamma =\left( 1-2r^{2}\sin ^{2}\frac{\Delta x\theta
}{2}\right) \)</span>. The solutions of this quadratic equation are given by</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-41">
<span class="eqno">(11.42)<a class="headerlink" href="#equation-ref-fd-pdes-41" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray}
G_{1,2}=\gamma \pm \sqrt{\gamma ^{2}-1}
\end{eqnarray}
\]</div>
<p>Now since <span class="math notranslate nohighlight">\(G_1\)</span> and <span class="math notranslate nohighlight">\(G_2\)</span> are the roots of this quadratic we may
conclude that</p>
<div class="math notranslate nohighlight" id="equation-stabquadratic1">
<span class="eqno">(11.43)<a class="headerlink" href="#equation-stabquadratic1" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray}
(G-G_{1})(G-G_{2})=G^{2}-(G_{1}+G_{2})G+G_{1}G_{2}=0
\label{StabQuadratic1}
\end{eqnarray}
\]</div>
<p>Comparing the last terms in these two quadratic equations
(\ref{StabQuadratic}) and <a class="reference internal" href="#equation-stabquadratic1">(11.43)</a> we conclude that</p>
<div class="math notranslate nohighlight" id="equation-unitdiskconstraint">
<span class="eqno">(11.44)<a class="headerlink" href="#equation-unitdiskconstraint" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray}
G_{1}G_{2}=1. \label{unitDiskConstraint}
\end{eqnarray}
\]</div>
<p>However, for stability of solutions for the form <span class="math notranslate nohighlight">\(\phi _{k}=G^{k}\)</span>,
we require that <span class="math notranslate nohighlight">\(|G_1|\le 1\)</span> and <span class="math notranslate nohighlight">\(|G_2|\le 1\)</span>. Given the constraint
<a class="reference internal" href="#equation-unitdiskconstraint">(11.44)</a>, the only possibility, if the solutions
are to be stable, is that <span class="math notranslate nohighlight">\(|G_1|=|G_2|= 1\)</span>. Thus <span class="math notranslate nohighlight">\(G\)</span> must fall on
the unit disk, which implies that</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-44">
<span class="eqno">(11.45)<a class="headerlink" href="#equation-ref-fd-pdes-44" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray*}
|\gamma|\le 1
\end{eqnarray*}
\]</div>
<p>Thus</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-45">
<span class="eqno">(11.46)<a class="headerlink" href="#equation-ref-fd-pdes-45" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray*}
\left| 1-2r^{2}\sin ^{2}\frac{\Delta x\theta }{2}\right|\le 1
\end{eqnarray*}
\]</div>
<p>or</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-46">
<span class="eqno">(11.47)<a class="headerlink" href="#equation-ref-fd-pdes-46" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray*}
-1\le  1-2r^{2}\sin ^{2}\frac{\Delta x\theta }{2}\le 1
\end{eqnarray*}
\]</div>
<p>so that</p>
<div class="math notranslate nohighlight" id="equation-stabcondwaveeq">
<span class="eqno">(11.48)<a class="headerlink" href="#equation-stabcondwaveeq" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray}
-2\le -2r^{2}\sin ^{2}\frac{\Delta x\theta }{2}\le 0
\label{StabCondWaveEq}
\end{eqnarray}
\]</div>
<p>The second inequality in <a class="reference internal" href="#equation-stabcondwaveeq">(11.48)</a> is satisfied
automatically, while the first leads to the condition</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-48">
<span class="eqno">(11.49)<a class="headerlink" href="#equation-ref-fd-pdes-48" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray*}
r^{2}\sin ^{2}\frac{\Delta x\theta }{2}\le 1
\end{eqnarray*}
\]</div>
<p>Since the maximum value that <span class="math notranslate nohighlight">\(\sin ^{2}(\frac{\Delta x\theta }{2})\)</span>
can achieve is 1, we conclude that the condition for stability is</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-49">
<span class="eqno">(11.50)<a class="headerlink" href="#equation-ref-fd-pdes-49" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray*}
r=(c\Delta t/\Delta x)\le 1
\end{eqnarray*}
\]</div>
<p>or</p>
<div class="math notranslate nohighlight" id="equation-cfl-wave">
<span class="eqno">(11.51)<a class="headerlink" href="#equation-cfl-wave" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray}
\Delta t\le  \frac{\Delta x }{c} \label{CFL_Wave}
\end{eqnarray}
\]</div>
<p>The condition <a class="reference internal" href="#equation-cfl-wave">(11.51)</a>, which imposes an upper bound on the
time step that can be used, is known as the Courant-Friedrichs-Lewy
or CFL condition.</p>
</section>
</section>
<section id="solving-laplace-s-equation-using-finite-differences">
<h3><span class="section-number">11.1.4. </span>Solving Laplaceâ€™s Equation Using Finite Differences<a class="headerlink" href="#solving-laplace-s-equation-using-finite-differences" title="Permalink to this headline">#</a></h3>
<p>Consider the boundary value problem</p>
<div class="math notranslate nohighlight" id="equation-laplace">
<span class="eqno">(11.52)<a class="headerlink" href="#equation-laplace" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{eqnarray}
&amp; &amp; \frac{\displaystyle\partial^2u}{\displaystyle \partial x^2} +\frac{\partial ^2u}{\partial y^2}=0\quad 0&lt;x,y&lt;1 \label{Laplace}\\
\mbox{BC:}\quad &amp; u(0,y)=0; &amp;\quad u(1,y)=0;\quad u(x,0)=f(x);\quad
u(x,1)=0. \label{LaplaceBC}
\end{eqnarray}
\end{split}\]</div>
<figure class="align-center" id="laplace-scheme">
<img alt="laplace_scheme" src="../_images/laplace_scheme.png" />
</figure>
<p>As before we replace the second derivatives in <a class="reference internal" href="#equation-laplace">(11.52)</a> by
central difference quotients that are second order accurate:</p>
<div class="math notranslate nohighlight" id="equation-centdiffy">
<span class="eqno">(11.53)<a class="headerlink" href="#equation-centdiffy" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{eqnarray}
\frac{u(x+\Delta x,y)-2u(x,y)+u(x-\Delta x,y)}{\Delta x^2} &amp; = &amp; \frac{\partial^2u}{\partial x^2}(x,y)+O(\Delta x^2) \label{CentDiffX}\\
\frac{u(x,y+\Delta y)-2u(x,y)+u(x,y-\Delta y)}{\Delta y^2} &amp; = &amp;
\frac{\partial^2u}{\partial y^2}(x,y)+O(\Delta y^2) \label{CentDiffY}
\end{eqnarray}
\end{split}\]</div>
<p>We partition the interval <span class="math notranslate nohighlight">\(0\leq x\leq 1\)</span> into <span class="math notranslate nohighlight">\((N+1)\)</span> equally
spaced nodes <span class="math notranslate nohighlight">\(x_n=n\Delta x\)</span> and the interval <span class="math notranslate nohighlight">\(0\leq y\leq 1\)</span> into
<span class="math notranslate nohighlight">\((M+1)\)</span> equally spaced nodes <span class="math notranslate nohighlight">\(y_m=m\Delta y\)</span>. Replacing the derivatives
in <a class="reference internal" href="#equation-laplace">(11.52)</a> by the difference quotients in (\ref{CentDiffX})
and <a class="reference internal" href="#equation-centdiffy">(11.53)</a>, and representing the mesh values at
<span class="math notranslate nohighlight">\((x_n,y_m)\)</span> by <span class="math notranslate nohighlight">\(u_{nm}\simeq u(x_n,y_m)\)</span> we obtain:</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-53">
<span class="eqno">(11.54)<a class="headerlink" href="#equation-ref-fd-pdes-53" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray*}
\frac{u_{n+1m}-2u_{nm}+u_{n-1m}}{\Delta
x^2}+\frac{u_{nm+1}-2u_{nm}+u_{nm-1}}{\Delta
y^2}={(u_{xx}+u_{yy})}_{(x_n,x_m)}+O(\Delta x^2,\Delta y^2).
\end{eqnarray*}
\]</div>
<p>If we choose <span class="math notranslate nohighlight">\(\Delta x=\Delta y\)</span> then we obtain</p>
<div class="math notranslate nohighlight" id="equation-discretelaplace">
<span class="eqno">(11.55)<a class="headerlink" href="#equation-discretelaplace" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray}
u_{n+1m}+u_{n-1m}+u_{nm+1}+u_{nm-1}-4u_{nm}=0\quad 1\leq n,m\leq
(N-1),(M-1) \label{DiscreteLaplace}
\end{eqnarray}
\]</div>
<figure class="align-center" id="laplace-stencil">
<img alt="laplace_stencil" src="../_images/laplace_stencil.png" />
</figure>
<p>This is known as the finite difference `Stencilâ€™ that relates
<span class="math notranslate nohighlight">\(u_{nm}\)</span> to its 4 nearest neighbours.</p>
<p>This is a system of <span class="math notranslate nohighlight">\((N-1)\times (M-1)\)</span> unknowns for the values
of <span class="math notranslate nohighlight">\(u_{nm}\)</span> interior to the domain - recall the boundary values are
already specified!</p>
<section id="solving-the-system-of-equations-by-jacobi-iteration">
<h4><span class="section-number">11.1.4.1. </span>Solving the System of Equations by Jacobi Iteration<a class="headerlink" href="#solving-the-system-of-equations-by-jacobi-iteration" title="Permalink to this headline">#</a></h4>
<p>This is a procedure to solve the system of Equations
<a class="reference internal" href="#equation-discretelaplace">(11.55)</a> by looping through each of the mesh points
and updating <span class="math notranslate nohighlight">\(u_{nm}\)</span> according to <a class="reference internal" href="#equation-discretelaplace">(11.55)</a> assuming
that the nearest neighbours already have values close to the exact
solution. This procedure is repeated until the changes that are made
in each iteration falls below a certain tolerance.</p>
<p>To implement this iterative procedure we observe that the discrete
Laplace Equation <a class="reference internal" href="#equation-discretelaplace">(11.55)</a> can be re-written in the
form:</p>
<div class="math notranslate nohighlight" id="equation-jacobi">
<span class="eqno">(11.56)<a class="headerlink" href="#equation-jacobi" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray}
u_{nm}^{k+1}=\frac{u_{n+1m}^k+u_{n-1m}^k+u_{nm+1}^k+u_{nm-1}^k}{4}
\label{Jacobi}
\end{eqnarray}
\]</div>
<figure class="align-center" id="laplace-average">
<img alt="laplace_average" src="../_images/laplace_average.png" />
</figure>
<p>Thus <span class="math notranslate nohighlight">\(u_{nm}\)</span> is the average value of its nearest neighbours. Note
that a new superscript index <span class="math notranslate nohighlight">\(k\)</span> has been introduced to represent
the nodal values at the <span class="math notranslate nohighlight">\(k\)</span>th iteration. Thus iteration can be
viewed as taking successive neighbour averages until there is no
change, at which point the value of <span class="math notranslate nohighlight">\(u_{mn}\)</span> equals the average of
the values at its mesh neighbours. This mean value property is a
discrete form of a fundamental property of any solution to Laplaceâ€™s
Equation, which also implies that maxima or minima of solutions to
Laplaceâ€™s equation cannot occur inside the domain but must be
restricted to the boundary - a very useful poperty of Laplaceâ€™s
equation known as The Maximum Principle.</p>
<p>To implement the iterative procedure <a class="reference internal" href="#equation-jacobi">(11.56)</a> in a spread
sheet, go to the Tools Menu at the top of the screen and click
on the Options Tab. Then select the Calculation Tab.
Check the Iteration box. If you set the number of iterations
to 5 say, then if you start with zero values throughout the interior
of the domain (as you should if you cut and paste as demonstrated in
class), you will see the values percolate 5 cells into the domain
from the non zero boundary condition <span class="math notranslate nohighlight">\(f(x)=\sin (\pi x)\)</span>. You can
choose a surface plot to visualize the solution. Now hold down the
F9 key and watch the solution move to equilibrium. This
iterative process essentially uses diffusion on a pseudo time scale
to take the solution to equilibrium.\medskip</p>
</section>
<section id="exercises-for-laplace-s-equation">
<h4><span class="section-number">11.1.4.2. </span>Exercises for Laplaceâ€™s Equation<a class="headerlink" href="#exercises-for-laplace-s-equation" title="Permalink to this headline">#</a></h4>
<ol class="arabic simple">
<li><p>Implement a 0 derivative BC along the lines <span class="math notranslate nohighlight">\(x=0\)</span> and <span class="math notranslate nohighlight">\(x=1\)</span>:</p></li>
</ol>
<p>Plot a cross section of the results along <span class="math notranslate nohighlight">\(y=1/2\)</span>. To ensure that
<span class="math notranslate nohighlight">\(\displaystyle\frac{\partial u}{\partial x}(0,y)=0=\frac{\partial u}{\partial x}(1,y)\)</span></p>
<ol class="arabic simple" start="2">
<li><p>Implement an inhomogeneous term for Poissonâ€™s Equation:</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-56">
<span class="eqno">(11.57)<a class="headerlink" href="#equation-ref-fd-pdes-56" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray*}
\frac{\partial^2u}{\partial x^2}+\frac{\partial^2u}{\partial y^2}=f(x,y)\quad 0&lt;x,y&lt;1.
\end{eqnarray*}
\]</div>
<p>Introduce finite difference quotients, assume <span class="math notranslate nohighlight">\(\Delta x=\Delta y\)</span> to
arrive at the iterative formula:</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-57">
<span class="eqno">(11.58)<a class="headerlink" href="#equation-ref-fd-pdes-57" title="Permalink to this equation">#</a></span>\[
\begin{eqnarray*}
u_{nm}^{k+1}=\frac{\big(u_{n+1m}^k+u_{n-1m}^k+u_{nm+1}^k+u_{nm-1}^k-\Delta
x^2f(x_n,y_m)\big)}{4}.\quad (*)
\end{eqnarray*}
\]</div>
<p>It may be useful to calculate the values of <span class="math notranslate nohighlight">\(f_{nm}\)</span> on a separate
sheet in which the same cell values as those for <span class="math notranslate nohighlight">\(u_{nm}\)</span> are
maintained. Then the values of <span class="math notranslate nohighlight">\(f_{nm}\)</span> can be referenced in the
calculation of <span class="math notranslate nohighlight">\(u_{nm}\)</span> according to <span class="math notranslate nohighlight">\((*)\)</span>.</p>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./fd"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../fourier/separation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">10. </span>Separation of Variables and Fourier Series</p>
      </div>
    </a>
    <a class="right-next"
       href="formulas.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">12. </span>Finite Difference Formulas</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#finite-difference-methods">11.1. Finite Difference Methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#approximating-the-derivatives-of-a-function-by-finite-differences">11.1.1. Approximating the Derivatives of a Function by Finite Differences</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-the-heat-equations-using-the-method-of-finite-differences">11.1.2. Solving The Heat Equations Using The Method Of Finite Differences</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stability-of-the-finite-difference-scheme-for-the-heat-equation">11.1.2.1. Stability of the Finite Difference Scheme for the Heat Equation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises-on-finite-differences-applied-to-the-heat-equation">11.1.2.2. Exercises on Finite Differences Applied to the Heat Equation</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finite-difference-scheme-for-the-1d-wave-equation">11.1.3. Finite Difference Scheme For The 1D Wave Equation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stability-of-the-finite-difference-scheme-for-the-wave-equation">11.1.3.1. Stability of the Finite Difference Scheme for the Wave Equation</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-laplace-s-equation-using-finite-differences">11.1.4. Solving Laplaceâ€™s Equation Using Finite Differences</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-the-system-of-equations-by-jacobi-iteration">11.1.4.1. Solving the System of Equations by Jacobi Iteration</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises-for-laplace-s-equation">11.1.4.2. Exercises for Laplaceâ€™s Equation</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By UBC Math
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      Â© Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>