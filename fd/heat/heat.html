

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>12.1. FTCS Method &#8212; MATH 316</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'fd/heat/heat';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="13. Wave Equation" href="../wave.html" />
    <link rel="prev" title="12. Heat Equation" href="../heat.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    <p class="title logo__title">MATH 316</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Ordinary Differential Equations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../odes/review.html">1. Review of Methods to Solve Ordinary Differential Equations</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../odes/review/first.html">1.1. First Order Ordinary Differential Equations:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odes/review/second.html">1.2. Second Order Constant Coefficient Linear Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odes/review/cauchy.html">1.3. Cauchy/Euler/Equidimensional Equations:</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../odes/series.html">2. Series Solutions To ODEs With Variable Coefficients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../odes/rsps.html">3. Regular Singular Points</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../odes/frobenius.html">4. Frobenius Series About Regular Singular Points</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../odes/bessel.html">5. Bessel’s Equation and Bessel Functions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction to Partial Differential Equations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../intro/initial.html">6. Introduction To Partial Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro/continued.html">7. Introduction To Partial Differential Equations (Continued)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro/separation.html">8. Separation Of Variables And Fourier Series</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Fourier Series</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../fourier/series.html">9. Fourier Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fourier/separation.html">10. Separation of Variables and Fourier Series</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Finite Difference Method</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../fd.html">11. Overview and Formulas</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../heat.html">12. Heat Equation</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">12.1. FTCS Method</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../wave.html">13. Wave Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../laplace.html">14. Laplace Equation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Heat Equation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../heat/heat.html">15. Heat Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../heat/circular.html">16. Heat Equation On A Circular Ring - Full Fourier Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../heat/inhomogeneous.html">17. Heat Conduction Problems With Time-Independent Inhomogeneous Boundary Conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../heat/distributed.html">18. Heat Conduction With Distributed Sources/Sinks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../heat/eigenfunctions.html">19. Heat Conduction With Time Dependent Boundary Conditions Using Eigenfunction Expansions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Laplace Equation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../laplace/laplace.html">20. Laplace Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../laplace/2d.html">21. Laplace’s Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../laplace/rectangular.html">22. More Rectangular Domains: Neumann Problems, Mixed BCs, And Semi-Infinite Strip Problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../laplace/circular.html">23. Circular Domains</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../laplace/wedges.html">24. Wedges With Cut-Outs, Dirichlet And Neumann Problems On Circular Domains</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Wave Equation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../wave/wave.html">25. Wave Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../wave/1d.html">26. The 1D Wave Equation and D’Alembert’s Solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../wave/dalembert.html">27. Interpretating D’Alembert’s Solution in Space-Time</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../wave/finite.html">28. The Wave Equation On Finite Domains - Solution By Separation Of Variables</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/UBCMath/math316" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/fd/heat/heat.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>FTCS Method</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forward-time-central-space-ftcs">12.1.1. Forward Time Central Space (FTCS)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementing-derivative-boundary-conditions">12.1.2. Implementing Derivative Boundary Conditions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stability-of-ftcs">12.1.3. Stability of FTCS</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">12.1.4. Exercises</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="ftcs-method">
<h1><span class="section-number">12.1. </span>FTCS Method<a class="headerlink" href="#ftcs-method" title="Permalink to this headline">#</a></h1>
<section id="forward-time-central-space-ftcs">
<h2><span class="section-number">12.1.1. </span>Forward Time Central Space (FTCS)<a class="headerlink" href="#forward-time-central-space-ftcs" title="Permalink to this headline">#</a></h2>
<p>Consider the following initial-boundary value problem for the heat equation</p>
<div class="math notranslate nohighlight" id="equation-heateq">
<span class="eqno">(12.1)<a class="headerlink" href="#equation-heateq" title="Permalink to this equation">#</a></span>\[\begin{split}
\frac{\partial u}{\partial t} &amp;= \alpha^2\frac{\partial ^2u}{\partial x^2} \quad 0&lt;x&lt;1, \quad t&gt;0 \\
\text{BC:}\quad u(0,t) &amp;= u(1,t) = 0 \\
\text{IC:}\quad u(x,0) &amp;= f(x)
\end{split}\]</div>
<p>The basic idea is to replace the derivatives in the heat equation by difference quotients. We consider the relationships between <span class="math notranslate nohighlight">\(u\)</span> at <span class="math notranslate nohighlight">\((x,t)\)</span> and its neighbours a distance <span class="math notranslate nohighlight">\(\Delta x\)</span> apart and at a time <span class="math notranslate nohighlight">\(\Delta t\)</span> later.</p>
<p>Corresponding to the difference quotient approximations introduced in <a class="reference internal" href="../fd.html#fd-intro"><span class="std std-ref">Finite Difference Formulas</span></a>, we consider the following partial difference approximations.</p>
<p>Start with the Taylor series with respect to <span class="math notranslate nohighlight">\(t\)</span></p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-9">
<span class="eqno">(12.2)<a class="headerlink" href="#equation-ref-fd-pdes-9" title="Permalink to this equation">#</a></span>\[
u(x,t+\Delta t) = u(x,t)+\Delta t\frac{\partial u}{\partial t} (x,t)+\frac{\Delta t^2}{2!}\frac{\partial ^2u}{\partial t^2} (x,t)+\cdots
\]</div>
<p>and then re-arrange and divide by <span class="math notranslate nohighlight">\(\Delta t\)</span> to obtain the <strong>forward difference in time</strong> approximation</p>
<div class="math notranslate nohighlight" id="equation-timedifference">
<span class="eqno">(12.3)<a class="headerlink" href="#equation-timedifference" title="Permalink to this equation">#</a></span>\[
\frac{u(x,t+\Delta t)-u(x,t)}{\Delta t} =\frac{\partial u}{\partial t}(u,t)+O(\Delta t)
\]</div>
<p>Now consider the following Taylor series with respect to <span class="math notranslate nohighlight">\(x\)</span></p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-11">
<span class="eqno">(12.4)<a class="headerlink" href="#equation-ref-fd-pdes-11" title="Permalink to this equation">#</a></span>\[\begin{split}
u(x + \Delta x,t) &amp;= u(x,t) + \Delta x\frac{\partial u}{\partial x}(x,t) +\frac{\Delta x^2}{2!}\frac{\partial^2u}{\partial x^2}(u,t) \\
&amp; + \frac{\Delta x^3}{3!}\frac{\partial^3u}{\partial x^3}(x,t) + \frac{\Delta x^4}{4!}\frac{\partial ^4u}{\partial x^2}(x,t)+\cdots \\
u(x - \Delta x,t) &amp;= u(x,t)-\Delta x\frac{\partial u}{\partial x}(x,t) +\frac{\Delta x^2}{2!}\frac{\partial ^2u}{\partial x^2}(x,t) \\
&amp; - \frac{\Delta x^3}{3!}\frac{\partial^3u}{\partial x^3}(x,t) +\frac{\Delta x^4}{4!}\frac{\partial ^4u}{\partial x^4}(x,t)+\cdots
\end{split}\]</div>
<p>Adding and re-arranging yields the <strong>central differences in space</strong> approximation</p>
<div class="math notranslate nohighlight" id="equation-centraldiffspace">
<span class="eqno">(12.5)<a class="headerlink" href="#equation-centraldiffspace" title="Permalink to this equation">#</a></span>\[
\frac{u(x+\Delta x,t)-2u(x,t)+u(x-\Delta x,t)}{\Delta x^2}=\frac{\partial ^2u}{\partial x^2}(x,t) +O(\Delta x^2)
\]</div>
<p>Substituting <a class="reference internal" href="#equation-timedifference">(12.3)</a> and <a class="reference internal" href="#equation-centraldiffspace">(12.5)</a> into <a class="reference internal" href="#equation-heateq">(12.1)</a> we obtain</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-13">
<span class="eqno">(12.6)<a class="headerlink" href="#equation-ref-fd-pdes-13" title="Permalink to this equation">#</a></span>\[
\frac{u(x,t+\Delta t)-u(x,t)}{\Delta t}=\alpha ^2\left( \frac{u(x+\Delta x,t)-2u(x,t)+u(x-\Delta x,t)}{\Delta x^2}\right) +O(\Delta t,\Delta x^2)
\]</div>
<p>Re-arranging we get</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-14">
<span class="eqno">(12.7)<a class="headerlink" href="#equation-ref-fd-pdes-14" title="Permalink to this equation">#</a></span>\[
u(x,t+\Delta t)=u(x,t)+\alpha ^2\left(\frac{\Delta t}{\Delta x^2}\right) \left\{ u(x+\Delta x,t)-2u(x,t)+u(x-\Delta x,t)\right\}
\]</div>
<p>We subdivide the spatial interval <span class="math notranslate nohighlight">\([0,1]\)</span> into <span class="math notranslate nohighlight">\(N+1\)</span> equally spaced sample points <span class="math notranslate nohighlight">\(x_n=n\Delta x\)</span>. The time interval <span class="math notranslate nohighlight">\([0,T]\)</span> is subdivided into <span class="math notranslate nohighlight">\(M+1\)</span> equal time levels <span class="math notranslate nohighlight">\(t_k=k\Delta t\)</span>. At each of these space-time sample points we introduce approximations:</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-15">
<span class="eqno">(12.8)<a class="headerlink" href="#equation-ref-fd-pdes-15" title="Permalink to this equation">#</a></span>\[
u(x_n,t_k) \simeq u_n^k.
\]</div>
<figure class="align-center" id="fd-scheme">
<img alt="fd_scheme" src="../../_images/heat_eq_scheme.png" />
</figure>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-16">
<span class="eqno">(12.9)<a class="headerlink" href="#equation-ref-fd-pdes-16" title="Permalink to this equation">#</a></span>\[
u_n^{k+1}=u_n^k+\alpha ^2\left(\frac{\Delta t}{\Delta x^2}\right) \left(u_{n+1}^k-2u_n^k+u_{n-1}^k\right)
\]</div>
</section>
<section id="implementing-derivative-boundary-conditions">
<h2><span class="section-number">12.1.2. </span>Implementing Derivative Boundary Conditions<a class="headerlink" href="#implementing-derivative-boundary-conditions" title="Permalink to this headline">#</a></h2>
<p>Assume that the boundary conditions for <a class="reference internal" href="#equation-heateq">(12.1)</a> are changed to</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-17">
<span class="eqno">(12.10)<a class="headerlink" href="#equation-ref-fd-pdes-17" title="Permalink to this equation">#</a></span>\[
\text{BC:}\quad u(0,t)=0,\quad\frac{\partial u}{\partial x}(1,t)=0
\]</div>
<p>Consider a central difference approximation to <span class="math notranslate nohighlight">\(\displaystyle\frac{\partial u}{\partial x}(1,t)\)</span>, where <span class="math notranslate nohighlight">\(x_N=N \Delta x = 1\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-18">
<span class="eqno">(12.11)<a class="headerlink" href="#equation-ref-fd-pdes-18" title="Permalink to this equation">#</a></span>\[
\frac{u(x_N+\Delta x,t)-u(x_N-\Delta x,t)}{\Delta x}=0
\]</div>
<p>Re-arranging we obtain:</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-19">
<span class="eqno">(12.12)<a class="headerlink" href="#equation-ref-fd-pdes-19" title="Permalink to this equation">#</a></span>\[
u(x_N+\Delta x,t)=u(x_N-\Delta x,t)
\]</div>
<p>Since <span class="math notranslate nohighlight">\(x_N=1\)</span> we observe that <span class="math notranslate nohighlight">\(x_N+\Delta x\)</span> is outside the domain. To accomodate this we introduce an extra column <span class="math notranslate nohighlight">\(u_{N+1}\)</span> into which we copy the values <span class="math notranslate nohighlight">\(u_{N-1}\)</span>. In the column <span class="math notranslate nohighlight">\(x_N\)</span> we implement the same difference approximation for the Heat Equation, namely:</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-20">
<span class="eqno">(12.13)<a class="headerlink" href="#equation-ref-fd-pdes-20" title="Permalink to this equation">#</a></span>\[
u_N^{k+1}=u_N^k+\alpha ^2( \frac{\Delta t}{\Delta x^2} ) (u_{N+1}^k-2u_N^k+u_{N-1}^k)
\]</div>
<p>While <span class="math notranslate nohighlight">\(u_{N+1}^k=u_{N-1}^k \)</span> (see <span class="xref std std-ref">ref-fd-pdes-19</span>) since column <span class="math notranslate nohighlight">\(u_{N-1}^k\)</span> is copied to column <span class="math notranslate nohighlight">\(u_{N+1}^k\)</span>.</p>
<p>Note that this BC could be implemented another way without introducing the additional column, by eliminating <span class="math notranslate nohighlight">\(u_{N+1}\)</span> from <span class="math notranslate nohighlight">\((*)\)</span> and <span class="math notranslate nohighlight">\((**)\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-21">
<span class="eqno">(12.14)<a class="headerlink" href="#equation-ref-fd-pdes-21" title="Permalink to this equation">#</a></span>\[
u_{N}^{k+1}=u_N^k+2\alpha ^2\left(\frac{\Delta t}{\Delta x^2}\right)\left( u_{N-1}^k-u_N^k\right)
\]</div>
<p>If this latter equation is implemented at <span class="math notranslate nohighlight">\(x_N\)</span> there is no need to introduce an extra column <span class="math notranslate nohighlight">\(u_{N+1}\)</span> or to implement the difference equation given in (**) as the the derivative boundary condition is taken care of automatically.</p>
</section>
<section id="stability-of-ftcs">
<h2><span class="section-number">12.1.3. </span>Stability of FTCS<a class="headerlink" href="#stability-of-ftcs" title="Permalink to this headline">#</a></h2>
<p>Consider the following finite difference approximation to the 1D heat equation:</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-22">
<span class="eqno">(12.15)<a class="headerlink" href="#equation-ref-fd-pdes-22" title="Permalink to this equation">#</a></span>\[
u_n^{k+1}-u_n^k=\frac{\Delta t}{\Delta x^2} \left( u_{n+1}^k-2u_n^k+u_{n-1}^k\right)\quad \mbox{where} \quad u_n^k\simeq u(x_n,t_k)
\]</div>
<p>Let <span class="math notranslate nohighlight">\(\displaystyle u_n^k=\phi_ke^{in\Delta x\theta}\)</span> then</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-23">
<span class="eqno">(12.16)<a class="headerlink" href="#equation-ref-fd-pdes-23" title="Permalink to this equation">#</a></span>\[\begin{split}
(\phi_{k+1}-\phi_k) e^{in\Delta x\theta} &amp;= \frac{\Delta t}{\Delta x^2} \left( e^{i\Delta x\theta}-2+e^{-i\Delta x\theta}\right) \phi_k e^{in\Delta x\theta}\\
&amp;= \frac{\Delta t}{\Delta x^2}\left[ 2\cos (\theta\Delta x)-2\right]\phi_k e^{in\Delta x\theta}
\end{split}\]</div>
<p>Therefore</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-24">
<span class="eqno">(12.17)<a class="headerlink" href="#equation-ref-fd-pdes-24" title="Permalink to this equation">#</a></span>\[\begin{split}
\phi_{k+1} &amp;= \phi_k-\frac{\Delta t}{\Delta x^2}4\sin^2\left(\frac{\theta\Delta x}{2}\right)\phi_k \quad \mbox{since} \quad\cos (\theta\Delta x)-1=-2\sin^2 \left(\frac{\theta\Delta x}{2}\right)\\
&amp;= \left[1-\frac{4\Delta t}{\Delta x^2}\sin^2\left(\frac{\theta\Delta x}{2}\right)\right]\phi_k
\end{split}\]</div>
<p>Now for stability we require that <span class="math notranslate nohighlight">\(|\phi_{k+1}|\leq |\phi_k|\)</span> so that</p>
<div class="math notranslate nohighlight">
\[
\left| 1-\frac{4\Delta t}{\Delta x^2}\sin^2\left(\frac{\theta\Delta x}{2}\right)\right|\leq 1
\]</div>
<p>and therefore</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-25">
<span class="eqno">(12.18)<a class="headerlink" href="#equation-ref-fd-pdes-25" title="Permalink to this equation">#</a></span>\[
-2\leq -\frac{4\Delta t}{\Delta x^2}\sin^2\left(\frac{\theta\Delta x}{2}\right)\leq 0
\]</div>
<p>The right inequality is satisfied automatically, while the left inequality can be re-written  in the form:</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-26">
<span class="eqno">(12.19)<a class="headerlink" href="#equation-ref-fd-pdes-26" title="Permalink to this equation">#</a></span>\[
\frac{4\Delta t}{\Delta x^2}\sin^2\left(\frac{\theta\Delta x}{2}\right)\leq 2
\]</div>
<p>Since <span class="math notranslate nohighlight">\(\sin^2(\theta \Delta x / 2) \leq 1\)</span> for all <span class="math notranslate nohighlight">\(\theta\)</span>, the condition <span class="xref std std-ref">ref-fd-pdes-26</span> is satisfied provided</p>
<div class="math notranslate nohighlight" id="equation-eqstabilitycondheat">
<span class="eqno">(12.20)<a class="headerlink" href="#equation-eqstabilitycondheat" title="Permalink to this equation">#</a></span>\[
\Delta t\le\frac{\Delta x^2}{2}
\]</div>
</section>
<section id="exercises">
<h2><span class="section-number">12.1.4. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">#</a></h2>
<p><strong>Numerical Instability:</strong></p>
<p>(a) Change the <span class="math notranslate nohighlight">\(\Delta t\)</span> in cell D1 from <span class="math notranslate nohighlight">\(0{.}001\)</span> to <span class="math notranslate nohighlight">\(0{.}05\)</span> and you will observe what is known as a numerical instability. Now change <span class="math notranslate nohighlight">\(\Delta t\)</span> to <span class="math notranslate nohighlight">\(0{.}00625\)</span>, which is known as the stability boundary predicted by <a class="reference internal" href="#equation-eqstabilitycondheat">(12.20)</a> and observe what happens. Now let <span class="math notranslate nohighlight">\(\Delta t=0{.}006\)</span> and observe the abrupt change in the solution - it is much closer to what we would expect.</p>
<p>(b) Derive the stability condition for the finite difference approximation of the 1D heat equation when <span class="math notranslate nohighlight">\(\alpha^2\ne 1\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-28">
<span class="eqno">(12.21)<a class="headerlink" href="#equation-ref-fd-pdes-28" title="Permalink to this equation">#</a></span>\[
u_n^{k+1}-u_n^k=\frac{\alpha^2\Delta t}{\Delta x^2}\left( u_{n+1}^k-2u_n^k+u_{n-1}^k\right)
\]</div>
<p><strong>Truncation Error:</strong></p>
<p>The instability noted in 1 above is not the only source of error in the numerical approximation. Although numerical instability is evident for a parameter choice that is unstable, the other type of error is present in almost every type of numerical approximation scheme.  This class of error results from discarding the <span class="math notranslate nohighlight">\(O(\Delta x^2)\)</span> and <span class="math notranslate nohighlight">\(O(\Delta t)\)</span> terms in <a class="reference internal" href="../fd.html#equation-centraldiff1">(11.7)</a> and <a class="reference internal" href="../fd.html#equation-forwarddiff">(11.4)</a> when we replace derivatives in <a class="reference internal" href="#equation-heateq">(12.1)</a> by difference quotients. This error is known as the truncation error. To estimate the magnitude of the truncation error, change the spread sheet to implement the initial condition</p>
<div class="math notranslate nohighlight" id="equation-ref-fd-pdes-29">
<span class="eqno">(12.22)<a class="headerlink" href="#equation-ref-fd-pdes-29" title="Permalink to this equation">#</a></span>\[\begin{split}
f(x)=\left\{\begin{array}{ll}2x &amp;0&lt;x&lt;1/2\\ 2(1-x)&amp;1/2\leq x &lt;1\end{array}\right. .
\end{split}\]</div>
<p>Now code up the Fourier Series (in another spread sheet) that is derived in Lecture 10, Exercise 10.1 and compare the numerical solution to the “exact” Fourier Series solution with 50 terms. The difference between the two is mainly due to the truncation error since the round-off error is about <span class="math notranslate nohighlight">\(10^{-12}\)</span> and does not grow if stable parameters are used.</p>
<p><strong>Derivative Boundary Conditions:</strong></p>
<p>Implement a derivative boundary condition the left endpoint <span class="math notranslate nohighlight">\(x=0\)</span>. Check the numerical solution against the problem solved in Lecture 11.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./fd/heat"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../heat.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">12. </span>Heat Equation</p>
      </div>
    </a>
    <a class="right-next"
       href="../wave.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">13. </span>Wave Equation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forward-time-central-space-ftcs">12.1.1. Forward Time Central Space (FTCS)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementing-derivative-boundary-conditions">12.1.2. Implementing Derivative Boundary Conditions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stability-of-ftcs">12.1.3. Stability of FTCS</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">12.1.4. Exercises</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By UBC Math
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>